(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{368:function(t,e,s){t.exports=s.p+"assets/img/venus-cluster.2e72d412.png"},394:function(t,e,s){"use strict";s.r(e);var a=s(17),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"introduction-of-cluster-components-of-venus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction-of-cluster-components-of-venus"}},[t._v("#")]),t._v(" Introduction of cluster components of Venus")]),t._v(" "),a("p",[t._v("Venus is one of the implementation schemes of filecoin.\nThe system components include: venus, venus-auth, venus-miner, venus-wallet, venus-messager and venus-sealer.\nConceptually, venus, venus-auth, venus-miner, venus-wallet and venus-messager can be shared (that is, the program can be used by multiple miners to make full use of hardware and software resources while ensuring efficiency), while venus-sealer, venus-worker and venus-wallet are mainly used to accumulate power.")]),t._v(" "),a("p",[a("img",{attrs:{src:s(368),alt:"venus-cluster"}})]),t._v(" "),a("h1",{attrs:{id:"deploying-venus-cluster-based-on-nerpa"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploying-venus-cluster-based-on-nerpa"}},[t._v("#")]),t._v(" Deploying Venus cluster (based on Nerpa)")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("program")]),t._v(" "),a("th",[t._v("server")]),t._v(" "),a("th",[t._v("type")]),t._v(" "),a("th",[t._v("purpose")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Venus-auth")]),t._v(" "),a("td",[t._v("<IP1>")]),t._v(" "),a("td",[t._v("Shared")]),t._v(" "),a("td",[t._v("Venus auth is used for unified authorization. When a miner's own running component accesses a shared component, it needs to use this service to register the generated token.")])]),t._v(" "),a("tr",[a("td",[t._v("Venus-wallet")]),t._v(" "),a("td",[t._v("<IP2>")]),t._v(" "),a("td",[t._v("Shared")]),t._v(" "),a("td",[t._v("Manage your wallet, Message signature")])]),t._v(" "),a("tr",[a("td",[t._v("Venus")]),t._v(" "),a("td",[t._v("<IP3>")]),t._v(" "),a("td",[t._v("Shared")]),t._v(" "),a("td",[t._v("chain Sync")])]),t._v(" "),a("tr",[a("td",[t._v("Venus-messager")]),t._v(" "),a("td",[t._v("<IP4>")]),t._v(" "),a("td",[t._v("Shared")]),t._v(" "),a("td",[t._v("Manage the message in the cluster, ensure the message on the chain, control the message flow, and try again. It can dock multiple wallets and manage messages for these wallets.")])]),t._v(" "),a("tr",[a("td",[t._v("Venus-miner")]),t._v(" "),a("td",[t._v("<IP5>")]),t._v(" "),a("td",[t._v("Shared")]),t._v(" "),a("td",[t._v("Package the block message; Multiple miners can be configured; It can calculate the miner's minning situation by itself, and obtain data proof through remote access to venus-sealer.")])]),t._v(" "),a("tr",[a("td",[t._v("Venus-sealer")]),t._v(" "),a("td",[t._v("<IP6>")]),t._v(" "),a("td",[t._v("Unshared")]),t._v(" "),a("td",[t._v("Sealing data")])])])]),t._v(" "),a("p",[t._v("Tips:")]),t._v(" "),a("ul",[a("li",[t._v("All the following "),a("code",[t._v("<>")]),t._v(" are parameters that need to be replaced, according to their own actual situation")]),t._v(" "),a("li",[t._v("Please use ‘git checkout’ to select the specific version")]),t._v(" "),a("li",[t._v("Environmental dependence:\n"),a("ul",[a("li",[t._v("golang ^1.15\n"),a("ul",[a("li",[t._v("go env -w GOPROXY=https://goproxy.io,direct")]),t._v(" "),a("li",[t._v("go env -w GO111MODULE=on")])])]),t._v(" "),a("li",[t._v("git")])])])]),t._v(" "),a("h2",{attrs:{id:"_1-venus-auth-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-venus-auth-install"}},[t._v("#")]),t._v(" 1. Venus-auth Install")]),t._v(" "),a("h3",{attrs:{id:"compile-and-start"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compile-and-start"}},[t._v("#")]),t._v(" Compile and start")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-auth.git\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-auth\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("The default configuration file directory of Venus auth service is: ~/.venus-auth/config.toml")]),t._v(" "),a("li",[t._v("The default storage scheme is the badger embedded kv database, which also supports MySQL storage. You need to modify the configuration file to start.")]),t._v(" "),a("li",[t._v("The default of log storage is console printing, and it also supports influxdb storage.")])]),t._v(" "),a("h4",{attrs:{id:"mysql-storage-startup-optional"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-storage-startup-optional"}},[t._v("#")]),t._v(" MySQL storage startup (optional)")]),t._v(" "),a("p",[t._v("Tips: MySQL supports official versions above 5.7（If the default settings of MySQL on the cloud platform are different, please modify the configuration in combination with the cloud platform, otherwise , may appear “ Specified key was too long; max key length is 767 bytes ” ）")]),t._v(" "),a("ul",[a("li",[t._v("Initialize database and table")])]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("CREATE DATABASE `venus_auth` /*!40100 DEFAULT CHARACTER SET utf8 */;\nUSE `venus_auth`;\n\nCREATE TABLE `token` (\n     `name` varchar(50) NOT NULL,\n     `token` varchar(512) NOT NULL,\n     `createTime` datetime NOT NULL,\n     `perm` varchar(50) NOT NULL,\n     `extra` varchar(255) DEFAULT NULL,\n     UNIQUE KEY `token_token_IDX` (`token`) USING HASH\n) ENGINE=InnoDB\n  DEFAULT CHARSET = utf8\n  COLLATE = utf8_general_ci;\n\n")])])]),a("ul",[a("li",[t._v("Modifying DB settings in venus-auth config")])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus-auth/config.toml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Data source configuration item")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# support: badger (default), mysql ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the mysql DDL is in the script package ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The following parameters apply to MySQL")]),t._v("\nDSN "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root:111111@(127.0.0.1:3306)/venus_auth?parseTime=true&loc=Local&charset=utf8mb4&collation=utf8mb4_unicode_ci&readTimeout=10s&writeTimeout=10s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# conns 1500 concurrent")]),t._v("\nmaxOpenConns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("\nmaxIdleConns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v("\nmaxLifeTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"120s"')]),t._v("\nmaxIdleTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30s"')]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("start-up")])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h3",{attrs:{id:"register-and-generate-the-token-of-each-component"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#register-and-generate-the-token-of-each-component"}},[t._v("#")]),t._v(" Register and generate the token of each component")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ ./venus-auth genToken --perm admin miner\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token miner"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n$ ./venus-auth genToken --perm admin messager\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token messager"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n$ ./venus-auth genToken --perm admin sealer\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token sealer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("<auth token ?>")]),t._v(" The format is unified as JWT token")]),t._v(" "),a("li",[t._v("These tokens will be used by various programs to verify the cluster access components")]),t._v(" "),a("li",[a("code",[t._v("--perm")]),t._v("--Perm is the access restriction of PRC2.0 interface")]),t._v(" "),a("li",[t._v('miner，messager，sealer，It is recommended to mark it as the program name. If there are multiple same programs to join the cluster, you can use "program name + tag".')])]),t._v(" "),a("h2",{attrs:{id:"_2-venus-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-venus-install"}},[t._v("#")]),t._v(" 2. Venus install")]),t._v(" "),a("h3",{attrs:{id:"install-the-compilation-environment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-the-compilation-environment"}},[t._v("#")]),t._v(" Install the compilation environment")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" gcc bzr jq pkgconfig clang llvm mesa-libGL-devel opencl-headers ocl-icd ocl-icd-devel hwloc-devel\n")])])]),a("h3",{attrs:{id:"compile-and-start-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compile-and-start-2"}},[t._v("#")]),t._v(" Compile and start")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus.git\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Start Venus daemon to set the address of the network and venus-auth")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# After successful startup, tail - F venus.log can see the log of data synchronization")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# It's going to take a while here")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network nerpa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--authURL http://"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":8989 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" \n\n")])])]),a("ul",[a("li",[a("code",[t._v("--authURL")]),t._v(" is set to listen to the HTTP address of venus-auth")])]),t._v(" "),a("h3",{attrs:{id:"modify-ipv4-listening-address"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-ipv4-listening-address"}},[t._v("#")]),t._v(" Modify IPv4 listening address")]),t._v(" "),a("p",[t._v("At present, after the program starts, the default listening address is "),a("code",[t._v("127.0.0.1:3453")]),t._v(". For cross server clusters, you need to modify the listening policy. You can query the process through "),a("code",[t._v("lsof -i:3453")]),t._v(" , kill the process, modify the IPv4 policy, and then restart.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus/config.json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Do the following operations to monitor all local IPv4 addresses:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# replace api.apiAddress from ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# "/ip4/127.0.0.1/tcp/3453"  to  "/ip4/0.0.0.0/tcp/3453"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Restart the service after modification:")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network nerpa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--authURL http://"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":8989 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("absolute path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"_3-venus-wallet-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-venus-wallet-install"}},[t._v("#")]),t._v(" 3. Venus-wallet install")]),t._v(" "),a("h3",{attrs:{id:"compile-and-start-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compile-and-start-3"}},[t._v("#")]),t._v(" Compile and start")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-wallet.git\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-wallet \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Compile")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# start")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-wallet run  --network test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" wallet.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h3",{attrs:{id:"set-password-and-create-wallet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-password-and-create-wallet"}},[t._v("#")]),t._v(" Set password and create Wallet")]),t._v(" "),a("blockquote",[a("p",[t._v("Here, two BLS wallets are created for the subsequent venus-sealer initialization")])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Set lock and unlock password")]),t._v("\n$ ./venus-wallet setpwd\nPassword:******\nEnter Password again:******\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Generate BLS address")]),t._v("\n$ ./venus-wallet new bls\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v("\n$ ./venus-wallet new bls\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("<bls address 1>")]),t._v(" is an 86 bit address")])]),t._v(" "),a("h4",{attrs:{id:"attention"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attention"}},[t._v("#")]),t._v(" Attention")]),t._v(" "),a("p",[t._v("The newly generated "),a("code",[t._v("<bls address 1>")]),t._v(" "),a("code",[t._v("<bls address 2>")]),t._v(" needs to be pre charged with balance in https://faucet.nerpa.interplanetary.dev/funds.html before actor can be generated on the chain.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ ./venus-wallet auth api-info --perm admin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("wallet jwt token"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("h2",{attrs:{id:"_4-venus-messager-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-venus-messager-install"}},[t._v("#")]),t._v(" 4. Venus-messager install")]),t._v(" "),a("h3",{attrs:{id:"compile-and-start-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compile-and-start-4"}},[t._v("#")]),t._v(" Compile and start")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-messager.git\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-messager\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Start the venus-messager process")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-messager run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":8989 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token messager"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--db-type mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--mysql-dsn "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root:111111@tcp(127.0.0.1:3306)/cali_venus?parseTime=true&loc=Local&readTimeout=10s&writeTimeout=10s"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" msg.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("--auth-url")]),t._v(" is to set venus-auth listening address")]),t._v(" "),a("li",[a("code",[t._v("--node-url")]),t._v(" is to set venus listening address")]),t._v(" "),a("li",[a("code",[t._v("--node-token")]),t._v(" JWT token registered in venus-auth represents its own node and is used for authentication when communicating with venus")])]),t._v(" "),a("h3",{attrs:{id:"add-wallet-link-multiple-wallet-links-can-be-added"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-wallet-link-multiple-wallet-links-can-be-added"}},[t._v("#")]),t._v(" Add wallet link (multiple wallet links can be added)")]),t._v(" "),a("blockquote",[a("p",[t._v("This side will periodically monitor the change of the accessible address of the venus-wallet "),a("br"),t._v("\nDelay dynamic tracking depends on the "),a("code",[t._v("list")]),t._v(" interface at "),a("code",[t._v("venus-wallet")])])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ ./venus-messager wallet "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--name testminer --url /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("/tcp/5678/http "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("wallet jwt token"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Query wallet list")]),t._v("\n$ ./venus-messager wallet list\n")])])]),a("ul",[a("li",[a("code",[t._v("--name")]),t._v(" adds wallet link name to venus-messager")]),t._v(" "),a("li",[a("code",[t._v("--url")]),t._v(" is to set the venus-wallet listening address")]),t._v(" "),a("li",[a("code",[t._v("--token")]),t._v(" Set the JWT token of interface authorization obtained in venus-wallet, and view the token at "),a("code",[t._v("<wallet jwt token>")]),t._v(" in Venus wallet install")])]),t._v(" "),a("h2",{attrs:{id:"_5-venus-sealer-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-venus-sealer-install"}},[t._v("#")]),t._v(" 5. Venus-sealer install")]),t._v(" "),a("h3",{attrs:{id:"sealer-has-two-kinds-of-jwt-token-concepts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sealer-has-two-kinds-of-jwt-token-concepts"}},[t._v("#")]),t._v(" sealer has two kinds of JWT token concepts")]),t._v(" "),a("ol",[a("li",[t._v("The local JWT token "),a("code",[t._v("<sealer jwt token>")]),t._v("  is used for other services to access sealer")]),t._v(" "),a("li",[t._v("The JWT token "),a("code",[t._v("<auth token sealer>")]),t._v(" registered by venus-auth is used for sealer to access messager")])]),t._v(" "),a("h3",{attrs:{id:"compile-and-start-sealer-single-program-can-only-bind-one-miner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compile-and-start-sealer-single-program-can-only-bind-one-miner"}},[t._v("#")]),t._v(" Compile and start (sealer single program can only bind one miner)")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-sealer.git\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-sealer\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),a("h4",{attrs:{id:"initialize-new-miner-1-out-of-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#initialize-new-miner-1-out-of-2"}},[t._v("#")]),t._v(" Initialize new miner (1 out of 2)")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-sealer init "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--worker "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--owner "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("bls address "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--sector-size 512M "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--network nerpa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token sealer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--messager-url http://"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(":39812/rpc/v0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--no-local-storage "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--messager-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token sealer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-name testminer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" sealer.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h4",{attrs:{id:"initialize-the-existing-miner-1-out-of-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#initialize-the-existing-miner-1-out-of-2"}},[t._v("#")]),t._v(" Initialize the existing miner (1 out of 2)")]),t._v(" "),a("blockquote",[a("p",[t._v("You do not need to specify "),a("code",[t._v("--sector-size")])])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ ./venus-sealer init "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--actor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--network nerpa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token sealer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--messager-url http://"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(":39812/rpc/v0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--no-local-storage "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--messager-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token sealer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-name testminer \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Check the log, wait for the message to be chained, and register the actor address")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.925+0800\tINFO\tmain\tvenus-sealer/init.go:182\tChecking "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" repo exists\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.926+0800\tINFO\tmain\tvenus-sealer/init.go:217\tChecking full node version\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.927+0800\tINFO\tmain\tvenus-sealer/init.go:233\tInitializing repo\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:31.928+0800\tINFO\tmain\tvenus-sealer/init.go:309\tInitializing libp2p identity\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:32.082+0800\tINFO\tmain\tvenus-sealer/init.go:485\tPushed CreateMiner message: aaf489f9-af4b-4e4b-9084-018d43f05b7e\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:41:32.082+0800\tINFO\tmain\tvenus-sealer/init.go:486\tWaiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" confirmation\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:46:32.088+0800\tINFO\tmain\tvenus-sealer/init.go:502\tNew miners address is: t01640 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t2cxzf7xvrqo3froqn2xgdqjdbydhkcrgakj7j3ma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:46:32.088+0800\tINFO\tmain\tvenus-sealer/init.go:381\tCreated new miner: t01640\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-04-25T18:46:32.089+0800\tINFO\tmain\tvenus-sealer/init.go:302\tSealer successfully created, you can now start it with "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'venus-sealer run'")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("--wallet-name testminer")]),t._v(" is the wallet connection added in the venus-messager, so in the wallet, the worker and owner specified here must exist in the venus-wallet")]),t._v(" "),a("li",[a("code",[t._v("<bls address 1>")]),t._v(" "),a("code",[t._v("<bls address 2>")]),t._v(" is the BLS wallet address created in venus-wallet. Note that balance is required for both wallet addresses")]),t._v(" "),a("li",[a("code",[t._v("<auth token sealer>")]),t._v("XXXX is the JWT token registered in venus-auth")]),t._v(" "),a("li",[a("code",[t._v("<absolute path>")]),t._v(" is the absolute path")])]),t._v(" "),a("h4",{attrs:{id:"start-sealer-and-perform-sector-encapsulation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#start-sealer-and-perform-sector-encapsulation"}},[t._v("#")]),t._v(" Start sealer and perform sector encapsulation")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-sealer run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" sealer.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Specify storage directory（optional）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Because --no-local-storage is specified")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# So you need to specify the sealer storage directory")]),t._v("\n$ ./venus-sealer storage attach --init --store --seal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("absolute path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Sector encapsulation command")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# You can do timing tasks through crontab, or you can write your own policy scripts")]),t._v("\n$ ./venus-sealer sectors pledge \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Query section list")]),t._v("\n$ ./venus-sealer sectors list\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Query actor address")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Here is <t0 addr>")]),t._v("\n$ ./venus-sealer info\n\nChain: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sync ok"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("basefee "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" aFIL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nSealer: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("512")]),t._v(" MiB sectors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nPower: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("  / "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" Ti "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0000")]),t._v("%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tRaw: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B / "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),t._v(" TiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0000")]),t._v("%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tCommitted: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" GiB\n\tProving: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B\nBelow minimum power threshold, no blocks will be won\nSealer Balance:    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("383.869")]),t._v(" FIL\n      PreCommit:  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      Pledge:     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("93.75")]),t._v(" mFIL\n      Vesting:    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      Available:  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("383.775")]),t._v(" FIL\nMarket Balance:   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n       Locked:    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n       Available: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nWorker Balance:   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" FIL\nTotal Spendable:  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1383.775")]),t._v(" FIL\n")])])]),a("h2",{attrs:{id:"_6-venus-miner-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-venus-miner-install"}},[t._v("#")]),t._v(" 6. Venus-miner install")]),t._v(" "),a("h3",{attrs:{id:"compile-and-start-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compile-and-start-5"}},[t._v("#")]),t._v(" Compile and start")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-miner.git\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-miner\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" nerpanet\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Initialize environment configuration")]),t._v("\n$ ./venus-miner init --api /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v("/tcp/3453 --token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auth token miner"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Startup miner")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-miner run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v("miner.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n\n$ ./venus-miner address "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--addr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--sealer-listen-api /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v("/tcp/2345/http "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--sealer-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("sealer jwt token"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-listen-api /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("/tcp/5678/http "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--wallet-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("wallet jwt token"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# print")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" miner:  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Query miner status")]),t._v("\n$ ./venus-miner address state \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# print")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Addr"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<t0 addr>"')]),t._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IsMining"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Err"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If IsMining is false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This command needs to be executed")]),t._v("\n$ ./venus-miner address start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("t0 addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Because miner supports multiple miners")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# You can view all the associated miners with the following command")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The start and stop of miners can be set by themselves")]),t._v("\n$ ./venus-miner address list\n")])])]),a("ul",[a("li",[a("code",[t._v("<t0 addr>")]),t._v(" can be viewed in the venus-sealer install section")]),t._v(" "),a("li",[a("code",[t._v("<sealer jwt token>")]),t._v(" is the JWT token of the venus-sealer node. After switching to the corresponding server, Execute "),a("code",[t._v("cat ~/.venussealer/token")]),t._v(" to get it")]),t._v(" "),a("li",[a("code",[t._v("<wallet jwt token>")]),t._v(" is to set the JWT token of interface authorization obtained in venus-wallet. Check the "),a("code",[t._v("<wallet jwt token>")]),t._v(" in venus-wallet install to find out how to obtain the token")])]),t._v(" "),a("h2",{attrs:{id:"_7-related-issues"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-related-issues"}},[t._v("#")]),t._v(" 7. Related issues")]),t._v(" "),a("ol",[a("li",[t._v("The Go mod has the following problems")])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("SECURITY ERROR\nThis download does NOT match an earlier download recorded "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" go.sum.\nThe bits may have been replaced on the origin server, or an attacker may\nhave intercepted the download attempt.\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# solution")]),t._v("\ngo clean -modcache\ngo mod tidy\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);